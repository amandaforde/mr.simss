---
title: "MR-SimSS: The algorithm"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{MR-SimSS: The algorithm}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```



### Introduction

A typical MR analysis is concerned with **estimating the causal effect, denoted by $\beta$, of a modifiable exposure, $X$ on a health-related outcome, $Y$**. When variables which confound the exposure-outcome relationship have not been observed, i.e. unmeasured confounders represented by $U$ are present, an MR study uses $n$ genetic variants, $G_1, G_2, \dots, G_n$, in an attempt to attain an unbiased causal effect estimate.

The image below displays a causal diagram representing the <u> assumed relationship between genetic variant $G_j$, exposure $X$ and outcome $Y$ in an MR analysis</u>. $U$ represents unobserved confounders, while $\gamma_j$ is the effect of the variant on the exposure and $\beta$ is the true exposure-outcome causal effect.


<br>

<p align="center">
<a href="https://github.com/amandaforde/winnerscurse_sims/blob/main/causal_diagram.jpg?raw=true"> 
<img src="https://github.com/amandaforde/winnerscurse_sims/blob/main/causal_diagram.jpg?raw=true" width="90%">
</a>
</p>

<br>



[$\star$]{style="color: darkblue;"} **Note:** A table is included at the bottom of the page ([here](https://amandaforde.github.io/mr.simss/articles/MR-SimSS-algorithm.html#notation)) detailing all notation used in this vignette. 


Here, the focus is on **summary-level MR**, a form of MR in which the analysis is conducted with summary statistics that have been generated using two large non-overlapping, or partially overlapping, exposure and outcome data sets. These summary statistics typically take the form of variant-exposure association estimates, variant-outcome association estimates and their corresponding standard errors, i.e. $\left( \widehat{\gamma_j}, \widehat{\sigma_{X_j}}\right)$ and $\left( \widehat{\Gamma_j}, \widehat{\sigma_{Y_j}}\right)$ for each genetic variant $j = 1, \dots, n$. To be more specific, the exposure data is used to regress $X$ on each $G_j$, $j = 1, \dots, n$, independently, yielding regression coefficients, $\widehat{\gamma_j}$ and standard errors, $\widehat{\sigma_{X_j}}$ in the process. In a similar manner, the regression coefficients, $\widehat{\Gamma_j}$  and standard errors,  $\widehat{\sigma_{Y_j}}$  are generated by regressing $Y$ on each $G_j$ separately in the outcome data set.

<br>

[$\star$]{style="color: darkblue;"} <span style="color:darkgreen;">**Potential sample overlap is permitted**</span> between the two data sets and therefore, it is <u>not assumed that for each genetic variant $j$, $\widehat{\gamma_j}$ and $\widehat{\Gamma_j}$ are independent</u>, i.e. it is possible that $\text{cov}\left( \widehat{\gamma_j}, \widehat{\Gamma_j} \right) \neq 0$.


### Intuition for MR-SimSS framework




Individual-level data setting:


think about images to describe!



Summary-level data setting: 


MR-SimSS is constructed on a desire to imitate the above when only summary-level data is available - 




### Assumptions made by MR-SimSS 

As with many statistical methods, the MR-SimSS framework makes <span style="color:darkblue;">**several assumptions**</span>:

<ul>
  <li> Firstly, the genetic association estimates with respect to both exposure and outcome are assumed to be **normally distributed** for each $j \in \{1, \dots, n\}$, i.e. $\widehat{\gamma_j} \sim N\left(\gamma_j, \sigma_{X_j}^2 \right)$ and $\widehat{\Gamma_j} \sim N\left(\Gamma_j, \sigma_{Y_j}^2 \right)$. This normality assumption frequently appears in the MR literature and is considered to be reasonable, based on asymptotic considerations, since <u>estimated associations are obtained from large GWASs</u>. 
  </li> 
  
  <li> It is assumed that the variance ratio $\frac{\sigma_{X_j}^2}{\sigma_{Y_j}^2}$for $j=1, \dots, n$ is both bounded away from zero and infinity. 
  </li>
  
  <li> The set of random variables **$\{\widehat{\gamma_j}, j=1, \dots, n\}$ are assumed to be mutually independent**, while similarly, **$\{\widehat{\Gamma_j}, j=1, \dots, n \}$ are assumed to be mutually independent**. However, $\gamma_j$ and $\Gamma_j$ are not necessarily independent due to participant overlap between the exposure and outcome data sets. To satisfy this assumption regarding independence among variants, a common step in MR studies is to first <u>employ LD pruning or clumping to produce a large set of uncorrelated genetic variants</u>, which the $p$ genetic instruments are then selected from. 
  </li>
  
  <li> The assumption that the **standard deviations $\sigma_{X_j}^2$ and $\sigma_{Y_j}^2$ for $j \in \{1, \dots, n\}$ are known**, is also made here. In fact, most, if not all, MR analyses conducted today assume that $\widehat{\sigma_{X_j}} \approx \sigma_{X_j}$ and $\widehat{\sigma_{Y_j}} \approx \sigma_{Y_j}$. This practice is deemed appropriate by many as large GWAS sample sizes ensure that the <u>variances of the genetic association estimates are computed with a great degree of accuracy</u>.
  
  </li>
  
</ul>












### Notation 
