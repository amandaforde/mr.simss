<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>MR-SimSS main function — mr_simss • mr.simss</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="MR-SimSS main function — mr_simss"><meta property="og:description" content="mr_simss is the main function for the method, MR-SimSS, which
is a method based on simulated sample splitting in order to alleviate
Winner's Curse bias in MR causal effect estimates. It also takes into
account sample overlap between the exposure and outcome GWASs. It uses GWAS
summary statistics and works in combination with existing MR methods, such as
IVW and MR-RAPS."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mr.simss</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/amandaforde/mr.simss" class="external-link">Source</a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>MR-SimSS main function</h1>
    <small class="dont-index">Source: <a href="https://github.com/amandaforde/mr.simss/blob/HEAD/R/mr_simss.R" class="external-link"><code>R/mr_simss.R</code></a></small>
    <div class="hidden name"><code>mr_simss.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>mr_simss</code> is the main function for the method, <strong>MR-SimSS</strong>, which
is a method based on simulated sample splitting in order to alleviate
<em>Winner's Curse</em> bias in MR causal effect estimates. It also takes into
account sample overlap between the exposure and outcome GWASs. It uses GWAS
summary statistics and works in combination with existing MR methods, such as
IVW and MR-RAPS.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mr_simss</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  subset <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sub.cut <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  est.lambda <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n.exposure <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  n.outcome <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  n.overlap <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  cor.xy <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  n.iter <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  splits <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  pi <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  pi2 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  threshold <span class="op">=</span> <span class="fl">5e-08</span>,</span>
<span>  mr_method <span class="op">=</span> <span class="st">"mr_ivw"</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n.cores <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lambda.thresh <span class="op">=</span> <span class="fl">0.5</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>A data frame to be inputted by the user containing summary
statistics from the exposure and outcome GWASs. It must have at least five
columns with column names <code>SNP</code>, <code>beta.exposure</code>,
<code>beta.outcome</code>, <code>se.exposure</code> and <code>se.outcome</code>. Each row must
correspond to a unique SNP, identified by <code>SNP</code>.</p></dd>


<dt>subset</dt>
<dd><p>A logical which permits the user to perform this method with
either the original complete set of SNPs or a subset of SNPs in order to
reduce computational time. The default setting is <code>subset=FALSE</code>.</p></dd>


<dt>sub.cut</dt>
<dd><p>A numerical value required if <code>subset=TRUE</code>, which ensures
that for a single iteration of our method, the number of instruments
selected if the full set of SNPs is used and the number of instruments if
merely the subset is used will be equal with probability at least
<code>1-sub.cut</code>.</p></dd>


<dt>est.lambda</dt>
<dd><p>A logical which allows the user to specify if they want to use
the function, <code>est_lambda</code>, to obtain an estimate for <em>lambda</em>, a
term used to describe the correlation between the SNP-outcome and
SNP-exposure effect sizes. This correlation is affected by the number of
overlapping samples between the two GWASs and the correlation between the
exposure and the outcome. Thus, it is recommended to use <code>est_lambda</code>
if the fraction of overlap and the correlation between exposure and outcome
are unknown. The default setting is <code>est.lambda=TRUE</code>.</p></dd>


<dt>n.exposure</dt>
<dd><p>A numerical value to be specified by the user which is equal
to the number of individuals that were in the exposure GWAS. It should be
specified by the user if <code>est.lambda=FALSE</code>. The default setting is
<code>n.exposure=1</code>.</p></dd>


<dt>n.outcome</dt>
<dd><p>A numerical value to be specified by the user which is equal
to the number of individuals that were in the outcome GWAS. It should be
specified by the user if <code>est.lambda=FALSE</code>. The default setting is
<code>n.outcome=1</code>.</p></dd>


<dt>n.overlap</dt>
<dd><p>A numerical value to be specified by the user which is equal
to the number of individuals that were in both the exposure and outcome
GWAS. It should be specified by the user if <code>est.lambda=FALSE</code>. The
default setting is <code>n.overlap=1</code>. The function requires that this value
is less than or equal to the minimum of <code>n.exposure</code> and
<code>n.outcome</code>.</p></dd>


<dt>cor.xy</dt>
<dd><p>A numerical value to be specified by the user which is equal to
the observed correlation between the exposure and the outcome. This value
must be between -1 and 1. It should be specified by the user if
<code>est.lambda=FALSE</code>. The default setting is <code>cor.xy=0</code>. If this
value is unknown, the user is encouraged to use the function
<code>est_lambda</code>.</p></dd>


<dt>n.iter</dt>
<dd><p>A numerical value which specifies the number of iterations of
the method, i.e. the number of times sample splits are randomly simulated.
The default setting is <code>n.iter=1000</code>.</p></dd>


<dt>splits</dt>
<dd><p>A numerical value that must be equal to 2 or 3, indicating
whether splits of 2 or 3 should be simulated. It is recommended that in the
case of no overlap between the two GWASs that splits of 2 should be used
while in the presence of overlap, especially full overlap, splits of 3
should be used. The default setting is <code>splits=2</code>.</p></dd>


<dt>pi</dt>
<dd><p>A numerical value which determines the fraction of the first split
in both the 2 and 3 split approaches. This is the fraction that will be used
for SNP selection. The default setting is <code>pi=0.5</code>. This value must be
between 0 and 1.</p></dd>


<dt>pi2</dt>
<dd><p>A numerical value which determines the fraction of the second split
in the 3 split approach. The default setting is <code>pi2=0.5</code>. This value
must be between 0 and 1.</p></dd>


<dt>threshold</dt>
<dd><p>A numerical value which specifies the threshold used to
select instrument SNPs for MR at each iteration. The default setting is
<code>threshold=5e-8</code>. This value must be between 0 and 1.</p></dd>


<dt>mr_method</dt>
<dd><p>A string which specifies the MR method that MR-SimSS works in
combination with. It is possible to use any method outputted in the list
<code>TwoSampleMR::mr_method_list()$obj</code>. However, it is currently advised
that the user chooses <code>"mr_ivw"</code> or <code>"mr_raps"</code>. The default
setting is <code>mr_method="mr_ivw"</code>.</p></dd>


<dt>parallel</dt>
<dd><p>A logical value which allows the user to specify if they wish
to use this function in parallel or in series. The default setting is
<code>parallel=TRUE</code>. It is advisable to use this default, especially when
<code>n.iter</code> is large.</p></dd>


<dt>n.cores</dt>
<dd><p>A numerical value which determines how many cores will be used
if <code>parallel=TRUE</code>. This value should be supplied by the user if they
wish to use less cores than the output of <code>parallel::detectCores()-1</code>.
The default setting is <code>n.cores=NULL</code>.</p></dd>


<dt>lambda.thresh</dt>
<dd><p>A value which is used when estimating <em>lambda</em> to
obtain a subset of SNPs which have absolute <em>z</em>-statistics for both exposure and outcome GWASs less than
this value. The method then assumes that both of the true SNP-outcome and
SNP-exposure effect sizes of each SNP in this subset are approximately 0.
The default setting is <code>lambda.thresh=0.5</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list containing two elements, <code>summary</code> and <code>results</code>.
<code>summary</code> is a data frame with one row which outputs <code>b</code>, the
estimated causal effect of exposure on outcome obtained using the
<strong>MR-SimSS</strong> method, as well as <code>se</code>, the associated standard
error of this estimate and <code>pval</code>, corresponding <em>p</em>-value. It
also contains the MR method used, the average number of instrument SNPs used
in each iteration and the number of iterations used. <code>results</code> is a
data frame which contains the output from each iteration. It is in a similar
style as the output from using the function <code>mr</code> from the
<code>TwoSampleMR</code> R package.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><a href="https://amandaforde.github.io/mr.simss/articles/perform-MR-SimSS.html" class="external-link">https://amandaforde.github.io/mr.simss/articles/perform-MR-SimSS.html</a>
for illustration of the use of <code>mr_simss</code> with a toy data set and further
information regarding this MR method.</p></div>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Amanda Forde.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

